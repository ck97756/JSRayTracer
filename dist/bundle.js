!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e,i){t.exports=function(){return new Worker(i.p+"worker.js")}},function(t,e,i){"use strict";i.r(e);class n{constructor(){1===arguments.length&&arguments[0]instanceof n?(this.x=arguments[0].x,this.y=arguments[0].y,this.z=arguments[0].z):3===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2]):(this.x=0,this.y=0,this.z=0)}plus(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z)}minus(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z)}multiply(t){return new n(this.x*t,this.y*t,this.z*t)}scaleToLength(t){let e=t/this.length();return new n(this.x*e,this.y*e,this.z*e)}normalize(){return this.scaleToLength(1)}cross(t){return new n(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}negative(){return new n(-this.x,-this.y,-this.z)}multiplyByVec3(t){return new n(this.x*t.x,this.y*t.y,this.z*t.z)}divide(t){return new n(this.x/t,this.y/t,this.z/t)}projectOnto(t){return t.multiply(this.dot(t.normalize()))}projectLength(t){return this.dot(t.normalize())}}class r{constructor(){1===arguments.length&&arguments[0]instanceof r?(this.x=arguments[0].x,this.y=arguments[0].y):2===arguments.length?(this.x=arguments[0],this.y=arguments[1]):(this.x=0,this.y=0)}divide(t){return new r(this.x/t,this.y/t)}divideByVec2(t){return new r(this.x/t.x,this.y/t.y)}multiplyByVec2(t){return new r(this.x*t.x,this.y*t.y)}floor(){return new r(Math.floor(this.x),Math.floor(this.y))}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}}class o{constructor(){this.position=new n,this.lookAt=new n,this.top=new n(0,0,1),this.focus=0,this.size=new r,this.canvasSize=new r}setView(t,e,i){this.position=new n(t),this.lookAt=new n(e),this.top=new n(i);let r=this.lookAt.minus(this.position);this.leftVector=this.top.cross(r).normalize(),this.topVector=r.cross(this.leftVector).normalize()}}var s=i(0),h=i.n(s);class a{constructor(t,e,i){this.x=t,this.y=e,this.remainIterator=i}}class l{constructor(){this.color=new n,this.iteratorCount=0}addColor(t){this.color=this.color.plus(t),this.iteratorCount++}getPixel(){let t=this.color.divide(this.iteratorCount),e=new Uint8ClampedArray(4);return e[0]=255*t.x,e[1]=255*t.y,e[2]=255*t.z,e[3]=255,e}}function c(){let t,e,i,s,c=new o;t=document.getElementById("canvas"),e=t.getContext("2d"),t.width=t.clientWidth,t.height=t.clientHeight,c.size=new r(10,10*t.height/t.width),c.canvasSize=new r(t.width,t.height),s=t.width*t.height,i=new Array(s);let u=new Array(s),d=0,y=Math.pow(2,12);for(let e=0;e<t.width;e++)for(let n=0;n<t.height;n++)u[d]=new a(e,n,y),i[d]=new l,d++;t.addEventListener("click",t=>{console.log(`position: ${t.offsetX}, ${t.offsetY}`);let i=e.getImageData(t.offsetX,t.offsetY,1,1);console.log(`color: ${i.data[0]}, ${i.data[1]}, ${i.data[2]}`)});let f=1,w=f;window.getProgress=(()=>{let e=y*t.width*t.height,i=0;for(let t of u)i+=t.remainIterator;return 1-i/e}),window.setThreadCount=function(o){for(f=o;w<f;w++){let o=new h.a;o.onmessage=(r=>{if("doneRender"===r.data.type){let s=r.data.x,h=r.data.y,a=h*t.width+s,l=new n(...r.data.data),c=i[a];c.addColor(l),e.putImageData(new ImageData(c.getPixel(),1,1),s,h),x(o)}}),o.postMessage({type:"initial",cameraSize:new r(10,10*t.height/t.width),canvasSize:new r(t.width,t.height)}),x(o),g.push(o)}};new r(Math.ceil(c.canvasSize.x/20),Math.ceil(c.canvasSize.y/20));let g=[],p=performance.now();for(let o=0;o<w;o++){let o=new h.a;o.onmessage=(r=>{if("doneRender"===r.data.type){let s=r.data.x,h=r.data.y,a=h*t.width+s,l=new n(...r.data.data),c=i[a];c.addColor(l),e.putImageData(new ImageData(c.getPixel(),1,1),s,h),x(o)}}),o.postMessage({type:"initial",cameraSize:new r(10,10*t.height/t.width),canvasSize:new r(t.width,t.height)}),x(o),g.push(o)}function x(t){if(f<w)return t.terminate(),g.splice(g.indexOf(t),1),void w--;if(s<=0){return void function(t){let e="",i=t%1e3,n=Math.floor(t/1e3),r=Math.floor(n/60),o=Math.floor(r/60),s=[Math.floor(o/24),o%=24,r%=60,n%=60];const h=["day","hour","minute","second"];let a=0;for(;a<s.length&&!(s[a]>0);a++);for(;a<s.length;a++)e=s[a]>1?`${e}${s[a]} ${h[a]}s `:`${e}${s[a]} ${h[a]} `;e=i>1?`${e}${i} milliseconds`:`${e}${i} millisecond`;console.log(e)}(performance.now()-p)}let e=Math.floor(Math.random()*s),i=u[e];i.remainIterator--,i.remainIterator<=0&&(u.splice(e,1),s--),t.postMessage({type:"renderRange",rangeStart:new r(i.x,i.y),rangeEnd:new r(i.x+1,i.y+1)}),0}}document.addEventListener("DOMContentLoaded",()=>{c()},!1)}]);
//# sourceMappingURL=bundle.js.map